---
title: "Flutterã®è‡ªå‹•ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã¨å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ‡ã‚Šæ›¿ãˆã§ãã‚‹ã‚ˆã†ã«Vimã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’è¨­å®šã—ãŸ"
emoji: "ğŸ¼"
type: "tech"
topics: ["vim", "neovim", "flutter", "dart"]
published: true
---

æœ€è¿‘ã¾ãŸæ”¹ã‚ã¦Flutterã§ã‚¢ãƒ—ãƒªã‚’ä½œã£ãŸã‚Šã—ã¦ã¾ã—ã¦ã€Riverpodã‚‚çµæ§‹é€²åŒ–ã—ã¦ã„ã‚‹ã‚‰ã—ãã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ã¦ã¾ã™ã€‚ãªã«ã‚„ã‚‰riverpod_generatorã§ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã™ã‚‹ã®ãŒãŠã™ã™ã‚ã‚‰ã—ã„ã¿ãŸã„ãªè©±ãŒã‚ã‚Šè©¦ã—ã¦ã¾ã™ã€‚

# riverpod_generator

riverpod_generatorã®ä½¿ã„æ–¹ã‚„ãƒ¡ãƒªãƒƒãƒˆã¯ä»¥å‰è³¼å…¥ã—ãŸæ‘æ¾ã•ã‚“ã®è¨˜äº‹ãŒå‚è€ƒã«ãªã‚Šã¾ã—ãŸï¼ˆè©²å½“ç®‡æ‰€ã¯ã„ã¾ã®ã¨ã“ã‚ç„¡æ–™ã§ã™ï¼‰ã€‚ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãŒå¯èƒ½ã«ãªã‚‹ã‚ãŸã‚Šã¯å¬‰ã—ã„ã§ã™ã­ã€‚

https://zenn.dev/riscait/books/flutter-riverpod-practical-introduction/viewer/riverpod-generator


åˆ‡ã‚Šæ›¿ãˆã‚‹ã®ã¯ç°¡å˜ã§ã€ãŸã¨ãˆã°ã‚·ãƒ³ãƒ—ãƒ«ãªFutureProviderã‚’ä½œã‚ŠãŸã„å ´åˆâ€¦ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ [Isarã£ã¦ã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹](https://isar.dev/ja/) ã‚’é–‹ãã‚³ãƒ¼ãƒ‰ãªã‚“ã§ã™ãŒã€

```dart: Before
final isarProvider = FutureProvider<Isar>((ref) async {
  return Isar.open([MemoSchema]);
});
```

```dart: After
@Riverpod(keepAlive: true)
Future<Isar> isar(IsarRef ref) async {
  return Isar.open([MemoSchema]);
}
```

ã¨ã„ã†æ„Ÿã˜ã§ã€å¾“æ¥ã¾ã§ä½¿ã£ã¦ã„ãŸ`isarProvider`ã¿ãŸãªã‚„ã¤ã¯ã€è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ã»ã†ã«è¨˜è¿°ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã¡ãªã¿ã«ã€ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

```dart
// GENERATED CODE - DO NOT MODIFY BY HAND

part of 'isar_provider.dart';

// **************************************************************************
// RiverpodGenerator
// **************************************************************************

String _$isarHash() => r'222169261f8ccbaf7b55c3ada3ca3b7c8cb5aa81';

/// See also [isar].
@ProviderFor(isar)
final isarProvider = FutureProvider<Isar>.internal(
  isar,
  name: r'isarProvider',
  debugGetCreateSourceHash:
      const bool.fromEnvironment('dart.vm.product') ? null : _$isarHash,
  dependencies: null,
  allTransitiveDependencies: null,
);

typedef IsarRef = FutureProviderRef<Isar>;
// ignore_for_file: unnecessary_raw_strings, subtype_of_sealed_class, invalid_use_of_internal_member, do_not_use_environment, prefer_const_constructors, public_member_api_docs, avoid_private_typedef_functions
```

å®Ÿéš›ã«ã“ã®Providerã‚’ä½¿ã„ãŸã„å ´é¢ã§ã¯ã€å¾“æ¥é€šã‚Š`isarProvider`ã‚’å‘¼ã³å‡ºã—ã¦ä½¿ã„ã¾ã™ã€‚

# å›°ã£ã¦ã„ã‚‹ã“ã¨

ã§ã¾ã‚ã“ã“ã‹ã‚‰ãŒã‚ˆã†ã‚„ãæœ¬é¡Œãªã‚“ã§ã™ãŒã€ä¾‹ãˆã°ã“ã†ã„ã£ãŸProviderã‚’ä½¿ã£ã¦ã„ã‚‹å´ã®ã‚¯ãƒ©ã‚¹ãªã‚Šã‚’ã„ã˜ã£ã¦ã‚‹æ™‚ã«ã€Œã“ã®Providerã£ã¦ã©ã‚“ãªå®Ÿè£…ã ã£ãŸã£ã‘ï¼Ÿã€ã£ã¦ç¢ºèªã—ãŸã„ã“ã¨ã‚ã‚‹ã˜ã‚ƒãªã„ã§ã™ã‹ã€‚ã§ã€ã¾ã‚LSPãªã‚Šã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—ã—ã¾ã™ã‚ˆã­ã€‚

ã™ã‚‹ã¨ã©ã†ã§ã—ã‚‡ã†ã€å½“ç„¶ãªãŒã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸã»ã†ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¡ã‚ƒã†ã‚ã‘ã§ã™ã€‚ä¿ºã¯å®Ÿè£…ã®ã»ã†ã‚’è¦‹ãŸã„ã‚“ã ã€ã£ã¦ãªã‚‹ã˜ã‚ƒãªã„ã§ã™ã‹ã€‚ã“ã£ã¡ã˜ã‚ƒã­ãƒ¼ã£ã™ã‚ˆã¨ã€‚

ã—ã‹ã—ãªãŒã‚‰ã§ã™ã‚ˆã€‚å®šç¾©ã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹æ™‚ã«ã‚ˆã—ãªã«ã—ã¦ãã‚Œã‚Œã°ã„ã„ã‚“ã ã‘ã©ã€ãã‚Œã¯ãªã‹ãªã‹é›£ã—ãã†ãªæ°—ãŒã™ã‚‹ã‚“ã§ã™ã­ãã£ã¨ã€‚

ã¨ã„ã†ã‚ã‘ã§ã€`xxx.g.dart`ã¨`xxx.dart`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’äº¤äº’ã«é–‹ã‘ã‚‹ã‚ˆã†ãªã‚­ãƒ¼ãƒãƒƒãƒ—ã‚’è¿½åŠ ã—ã¾ã—ãŸã¨ã„ã†è©±ã«ãªã‚‹ã‚ã‘ã§ã™ã€‚

# Vimã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚³ãƒ¼ãƒ‰

ã‚·ãƒ³ãƒ—ãƒ«ã«é–¢æ•°ä¸€å€‹ã§`dart`ã§ã—ã‹ä½¿ã‚ãªã„ã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’`~/.vim/ftplugin/dart.vim`ã«çªã£è¾¼ã‚“ã§ä½¿ã£ã¦ã¾ã™ã€‚ã‚­ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°ã¯`ga`ã¨ã‹ã‚„ã£ã¦ã¾ã™ã‘ã©ã€ãŠå¥½ã¿ã«ã‚ã‚ã›ã¦å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

```vim: ~/.vim/ftplugin/dart.vim
if exists("b:dart_ftplugin") | finish | endif

let b:dart_ftplugin = 1

command! -buffer -nargs=? SwitchPart call <SID>SwitchPartFile()

nnoremap <buffer> <silent> ga :cal<SID>SwitchPartFile()<cr>

if exists('*s:SwitchPartFile') | finish | endif

function! s:SwitchPartFile()
  let current_file = expand('%')

  let target_file = substitute(current_file, '\v(\.g)?\.dart$', '.g.dart', '')
  if target_file == current_file
    let target_file = substitute(current_file, '\v(\.g)?\.dart$', '.dart', '')
  endif

  if filereadable(target_file)
    exe 'e '.fnameescape(target_file)
  else
    echoh ErrorMsg | echo 'Target file not readable.' | echoh None
  endif
endfunction
```

ã¾ã ä½¿ã„è¾¼ã‚“ã§ã„ã‚‹ã‚ã‘ã˜ã‚ƒãªã„ã‚“ã§ä¾¿åˆ©ã‹ã‚ˆãã‚ã‹ã‚‰ãªã„ã‚“ã§ã™ã‘ã©ã‚‚ã€åŒã˜ã‚ˆã†ã«å›°ã£ã¦ã„ã‚‹æ–¹ã®åŠ©ã‘ã«ãªã‚Œã°ã€‚

